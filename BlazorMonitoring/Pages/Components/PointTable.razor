@using FM4017Library.Dtos
<h5>Points in selected Space</h5>


<table class="table table-striped table-hover">
    <thead>
        <tr>
            <th>Point Id</th>
            <th>Name</th>
            @*<th>Parent Space Id</th>*@
            <th>Point Created At</th>
            <th>Point Updated At</th>
            <th>Last signal value</th>
            <th>Unit</th>
            <th>Signal strength</th>
            <th>SNR</th>
            <th>Latitude</th>
            <th>Longitude</th>
            <th>Image Url</th>
        </tr>
    </thead>
    <tbody>
        @if (Points != null)
        {
            @foreach (var point in Points)
            {
                <tr @onclick="() => Select(point)">
                    <td>@point.Id</td>
                    <td>@point.Name</td>
                    @*<td>@point.SpaceId</td>*@
                    <td>@point.CreatedAt</td>
                    <td>@point.UpdatedAt</td>
                    <td>@point?.Signals?.SignalNodes?.LastOrDefault()?.Data?.RawValue</td>
                    <td>@point?.Signals?.SignalNodes?.LastOrDefault()?.Unit </td>
                    <td>@point?.Signals?.SignalNodes?.LastOrDefault()?.Metadata?.SignalStrength </td>
                    <td>@point?.Signals?.SignalNodes?.LastOrDefault()?.Metadata?.Snr </td>
                    <td>@point?.Metadata?.Latitude?.ToString("0.###")</td>
                    <td>@point?.Metadata?.Longitude?.ToString("0.###")</td>
                    @*<td>@point?.Metadata?.ImageUrl?</td>*@

                </tr>
            }
        }
    </tbody>
</table>

<br />
<br />
<SignalTable Signals="_selectedPoint?.Signals?.SignalNodes"></SignalTable>


@code {
    // Input to component
    [Parameter]
    public List<PointNode>? Points { get; set; }



    private PointNode? _selectedPoint;

    // List signals based on selection from user
    private void Select(PointNode point)
    {
        // clicked by user
        _selectedPoint = point;

    }
}
